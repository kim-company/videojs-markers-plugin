/*! videojs-markers-plugin - v1.0.2 - 2023-03-10
* Copyright (c) 2023 ; Licensed  */
!function(e,t){"function"==typeof define&&define.amd?define(["video.js"],t):"undefined"!=typeof exports?t(require("video.js")):(t(e.videojs),e.videojsMarkersPlugin={})}(this,function(e){"use strict";var h=(e=e)&&e.__esModule?e:{default:e};var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(e){return"Break: "+e.text},time:function(e){return e.time}},breakOverlay:{display:!1,displayTime:3,text:function(e){return"Break overlay: "+e.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(e){},onMarkerReached:function(e,t){},markers:[]};function b(e){var t;try{t=e.getBoundingClientRect()}catch(e){t={top:0,bottom:0,left:0,width:0,height:0,right:0}}return t}var T=-1;h.default.registerPlugin("markers",function(a){h.default.mergeOptions||(o=function(e){return!!e&&"object"===(void 0===e?"undefined":x(e))&&"[object Object]"===toString.call(e)&&e.constructor===Object},h.default.mergeOptions=function i(e,t){var n={};return[e,t].forEach(function(r){r&&Object.keys(r).forEach(function(e){var t=r[e];o(t)?(o(n[e])||(n[e]={}),n[e]=i(n[e],t)):n[e]=t})}),n}),h.default.dom.createEl||(h.default.dom.createEl=function(e,t,r){var i=h.default.Player.prototype.dom.createEl(e,t);return r&&Object.keys(r).forEach(function(e){i.setAttribute(e,r[e])}),i});var o,u=h.default.mergeOptions(g,a),s={},l=[],d=T,c=this,f=null,i=null,n=T;function t(){l.sort(function(e,t){return u.markerTip.time(e)-u.markerTip.time(t)})}function r(e){e.forEach(function(e){var r;e.key=(r=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)})),c.el().querySelector(".vjs-progress-holder").appendChild(function(r){var e=h.default.dom.createEl("div",{},{"data-marker-key":r.key,"data-marker-time":u.markerTip.time(r)});y(r,e),e.addEventListener("click",function(e){var t=!1;(t="function"==typeof u.onMarkerClick?!1===u.onMarkerClick(r):t)||(t=this.getAttribute("data-marker-key"),c.currentTime(u.markerTip.time(s[t])))}),u.markerTip.display&&function(l){l.addEventListener("mouseover",function(){var e,t,r,i,n,a,o=s[l.getAttribute("data-marker-key")];f&&(u.markerTip.html?f.querySelector(".vjs-tip-inner").innerHTML=u.markerTip.html(o):f.querySelector(".vjs-tip-inner").innerText=u.markerTip.text(o),f.style.left=m(o)+"%",e=b(f),t=b(l),r=f.querySelector(".vjs-tip-arrow"),a=f.querySelector(".vjs-tip-inner"),a=parseInt(getComputedStyle(a).maxWidth),t.left<a?(f.style.left="0px",f.style.right="unset",f.style.marginLeft="0px",n=parseInt(getComputedStyle(l).left),i=parseInt(getComputedStyle(r).width),r.style.left=i/(n<5?1:2)+n-(n<5?0:1)+"px",r.style.right="unset"):t.left>window.innerWidth-a-40?(f.style.left="unset",f.style.right="0px",i=parseInt(getComputedStyle(l).left),n=parseInt(getComputedStyle(r).width),a=window.innerWidth-i-40-2*n+2,r.style.left="unset",r.style.right=(a<5?5:a)+"px"):(r.style.left="50%",r.style.right="unset",f.style.right="unset",f.style.left=m(o)+"%",e=b(f),t=b(l),f.style.marginLeft=-parseFloat(e.width/2)+parseFloat(t.width/4)+"px"),f.style.visibility="visible")}),l.addEventListener("mouseout",function(){f&&(f.style.visibility="hidden")})}(e);return e}(e)),s[e.key]=e,l.push(e)}),t()}function m(e){return u.markerTip.time(e)/c.duration()*100}function y(e,t){t.className="vjs-marker "+(e.class||""),Object.keys(u.markerStyle).forEach(function(e){t.style[e]=u.markerStyle[e]});var r=e.time/c.duration();(r<0||1<r)&&(t.style.display="none"),t.style.left=m(e)+"%",e.duration?(t.style.width=e.duration/c.duration()*100+"%",t.style.marginLeft="0px"):(r=b(t),t.style.marginLeft=r.width/2+"px")}function p(e){i&&(n=T,i.style.visibility="hidden"),d=T;var r=[];e.forEach(function(e){var t=l[e];t&&(delete s[t.key],r.push(e),e=c.el().querySelector(".vjs-marker[data-marker-key='"+t.key+"']"))&&e.parentNode.removeChild(e)}),r.reverse(),r.forEach(function(e){l.splice(e,1)}),t()}function e(){var e,t,r;!u.breakOverlay.display||d<0||(e=c.currentTime(),t=l[d],(r=u.markerTip.time(t))<=e&&e<=r+u.breakOverlay.displayTime?(n!==d&&(n=d,i)&&(i.querySelector(".vjs-break-overlay-text").innerHTML=u.breakOverlay.text(t)),i&&(i.style.visibility="visible")):(n=T,i&&(i.style.visibility="hidden")))}function v(){!function(){if(l.length){var e=function(e){return e<l.length-1?u.markerTip.time(l[e+1]):c.duration()},t=c.currentTime(),r=T;if(d!==T){var i=e(d);if(t>=u.markerTip.time(l[d])&&t<i)return;if(d===l.length-1&&t===c.duration())return}if(t<u.markerTip.time(l[0]))r=T;else for(var n=0;n<l.length;n++)if(i=e(n),t>=u.markerTip.time(l[n])&&t<i){r=n;break}r!==d&&(r!==T&&a.onMarkerReached&&a.onMarkerReached(l[r],r),d=r)}}(),e(),a.onTimeUpdateAfterMarkerUpdate&&a.onTimeUpdateAfterMarkerUpdate()}function k(){u.markerTip.display&&(f=h.default.dom.createEl("div",{className:"vjs-tip",innerHTML:"<div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div>"}),c.el().querySelector(".vjs-progress-holder").appendChild(f)),c.markers.removeAll(),r(u.markers),u.breakOverlay.display&&(i=h.default.dom.createEl("div",{className:"vjs-break-overlay",innerHTML:"<div class='vjs-break-overlay-text'></div>"}),Object.keys(u.breakOverlay.style).forEach(function(e){i&&(i.style[e]=u.breakOverlay.style[e])}),c.el().appendChild(i),n=T),v(),c.on("timeupdate",v),c.off("loadedmetadata")}c.on("loadedmetadata",function(){k()}),c.markers={getMarkers:function(){return l},next:function(){for(var e=c.currentTime(),t=0;t<l.length;t++){var r=u.markerTip.time(l[t]);if(e<r){c.currentTime(r);break}}},prev:function(){for(var e=c.currentTime(),t=l.length-1;0<=t;t--){var r=u.markerTip.time(l[t]);if(r+.5<e)return void c.currentTime(r)}},add:function(e){r(e)},remove:function(e){p(e)},removeAll:function(){for(var e=[],t=0;t<l.length;t++)e.push(t);p(e)},updateTime:function(e){var i;i=e,l.forEach(function(e){var t=c.el().querySelector(".vjs-marker[data-marker-key='"+e.key+"']"),r=u.markerTip.time(e);!i&&t.getAttribute("data-marker-time")===r||(y(e,t),t.setAttribute("data-marker-time",r))}),t()},reset:function(e){c.markers.removeAll(),r(e)},destroy:function(){c.markers.removeAll(),i&&i.remove(),f&&f.remove(),c.off("timeupdate",e),delete c.markers}}})});